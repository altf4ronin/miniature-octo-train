name: CI
on:
  push:
    branches: [master]
  pull_request:
    branches: [master]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Set up JDK 11
        uses: actions/setup-java@v2
        with:
          java-version: '11'
          distribution: 'temurin' 
      - name: Build with Maven
        run: mvn -B package --file pom.xml
      - name: Run tests
        run: mvn test
      - name: Notify Telegram on success
        if: success()
        run: |
          curl -s -X POST https://api.telegram.org/bot7174970379:AAGPPyZP28gZhhTLuVMW9GgX8uTBnkLsYXo/sendMessage -d chat_id=767633532 -d text="All tests passed successfully."
      - name: Notify Telegram on failure
        if: failure()
        run: |
          curl -s -X POST https://api.telegram.org/bot7174970379:AAGPPyZP28gZhhTLuVMW9GgX8uTBnkLsYXo/sendMessage -d chat_id=767633532 -d text="Some tests failed."
